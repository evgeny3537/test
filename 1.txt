$pdfPath = "C:\Path\To\File.pdf"
$outputFolder = "C:\Path\To\Output\"
$resolutions = 300 # DPI

# Создаем COM-объекты
$acrobat = New-Object -ComObject AcroExch.App
$avDoc = New-Object -ComObject AcroExch.AVDoc

# Открываем PDF
if ($avDoc.Open($pdfPath, "")) {
    $pdDoc = $avDoc.GetPDDoc()
    $pageCount = $pdDoc.GetNumPages()

    for ($i = 0; $i -lt $pageCount; $i++) {
        $outputPath = Join-Path $outputFolder "Page_$($i+1).jpg"
        # Используем JavaScript для экспорта
        $js = "this.exportDataObject({ cPath: '$outputPath', nStart: $i, nEnd: $i, nResolution: $resolutions, cFormat: 'jpg' });"
        $pdDoc.CreateJSObject().execScript($js)
    }

    $avDoc.Close(-1) # Закрыть без сохранения
} else {
    Write-Error "Не удалось открыть PDF"
}

# Освобождаем ресурсы
[System.Runtime.Interopservices.Marshal]::ReleaseComObject($avDoc) | Out-Null
[System.Runtime.Interopservices.Marshal]::ReleaseComObject($pdDoc) | Out-Null
[System.Runtime.Interopservices.Marshal]::ReleaseComObject($acrobat) | Out-Null