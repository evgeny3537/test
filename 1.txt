# Путь к исходному PDF и папке для сохранения JPG
$pdfPath = "C:\Path\To\Your\File.pdf"
$outputFolder = "C:\Path\To\Output\Folder\"

# Создаем COM-объект Acrobat
$acrobat = New-Object -ComObject AcroExch.App
$pdDoc = New-Object -ComObject AcroExch.PDDoc

# Открываем PDF
if ($pdDoc.Open($pdfPath)) {
    # Получаем количество страниц
    $pageCount = $pdDoc.GetNumPages()
    
    # Настройки экспорта
    $resolutions = 300 # DPI
    $outputFormat = "jpg"
    
    # Экспорт каждой страницы
    for ($i = 0; $i -lt $pageCount; $i++) {
        $outputPath = Join-Path $outputFolder "Page_$($i+1).jpg"
        $pdDoc.Export($i, $i, $outputPath, "jpg", "com.adobe.acrobat.jpg", $resolutions, 0, 0)
    }
    
    # Закрываем документ
    $pdDoc.Close()
} else {
    Write-Error "Не удалось открыть PDF файл"
}

# Освобождаем COM-объекты
[System.Runtime.Interopservices.Marshal]::ReleaseComObject($pdDoc) | Out-Null
[System.Runtime.Interopservices.Marshal]::ReleaseComObject($acrobat) | Out-Null
[System.GC]::Collect()
[System.GC]::WaitForPendingFinalizers()