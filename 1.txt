# Пути и настройки
$pdfPath = "C:\Path\To\Your\File.pdf"
$outputDir = "C:\Output\Folder"
$baseName = "page_"
$jpgQuality = 80 # Качество JPG (1-100)

# Создаем COM-объект Acrobat
$acrobat = New-Object -ComObject Acrobat.Acrobat

# Открываем PDF
$pdfDoc = $acrobat.Open($pdfPath)

# Получаем количество страниц
$pages = $pdfDoc.GetNumPages()

# Создаем выходную директорию
if (-not (Test-Path $outputDir)) {
    New-Item -ItemType Directory -Path $outputDir | Out-Null
}

# Конвертируем каждую страницу
for ($i = 0; $i -lt $pages; $i++) {
    $outputPath = Join-Path $outputDir "$baseName$($i+1).jpg"
    
    # JavaScript для экспорта страницы
    $script = @"
    var pp = this.getPrintParams(); 
    pp.interactive = pp.constants.interactionLevel.silent;
    pp.printerName = "Adobe PDF";
    pp.pageHandling = pp.constants.pageHandling.pageRange;
    pp.pageRange = "$($i+1)";
    pp.printToFile = "$outputPath";
    this.print(pp);
    
    this.saveAs("$outputPath", "com.adobe.acrobat.jpeg", "$($i+1)", $jpgQuality);
"@

    # Выполняем JavaScript
    $pdfDoc.RunJavaScript($script, $null, 0)
}

# Закрываем документ и освобождаем ресурсы
$pdfDoc.Close()
[System.Runtime.Interopservices.Marshal]::ReleaseComObject($acrobat) | Out-Null
[System.GC]::Collect()
[System.GC]::WaitForPendingFinalizers()