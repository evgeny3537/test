function Write-HashText {
    param([string]$Text)

    Add-Type -AssemblyName System.Drawing
    # Используем жирный шрифт Impact или Arial Black для толщины
    $font = New-Object System.Drawing.Font("Arial Black", 10, [System.Drawing.FontStyle]::Bold)
    $brush = [System.Drawing.Brushes]::Black
    
    # Замеряем
    $tempBmp = New-Object System.Drawing.Bitmap(1, 1)
    $g = [System.Drawing.Graphics]::FromImage($tempBmp)
    $size = $g.MeasureString($Text, $font)
    $g.Dispose(); $tempBmp.Dispose()

    # Рисуем
    $bmp = New-Object System.Drawing.Bitmap([int]$size.Width, [int]$size.Height)
    $g = [System.Drawing.Graphics]::FromImage($bmp)
    $g.FillRectangle([System.Drawing.Brushes]::White, 0, 0, $bmp.Width, $bmp.Height)
    $g.DrawString($Text, $font, $brush, 0, 0)

    # Выводим в консоль
    for ($y = 0; $y -lt $bmp.Height; $y+=2) {
        $line = ""
        for ($x = 0; $x -lt $bmp.Width; $x++) {
            # Если пиксель темный - ставим #, иначе пробел
            if ($bmp.GetPixel($x, $y).R -lt 100) { $line += "#" } else { $line += " " }
        }
        Write-Host $line -ForegroundColor Cyan
    }
    $g.Dispose(); $bmp.Dispose()
}

# Запуск
Write-HashText "MAGIC BOX"
