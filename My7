# Бесконечный цикл оживления SMBv1
$ServerIP = "192.168.1.X" # Укажите IP сервера
$LoopInterval = 60        # Секунды

while ($true) {
    # Запускаем net view скрытно.
    # Нам не нужен вывод, нам нужен факт сетевого запроса NetShareEnum.
    # Start-Process гарантирует, что память очистится после закрытия net.exe
    Start-Process -FilePath "net.exe" `
                  -ArgumentList "view \\$ServerIP" `
                  -WindowStyle Hidden `
                  -Wait

    Start-Sleep -Seconds $LoopInterval
}
